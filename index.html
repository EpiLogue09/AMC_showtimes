<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Showtimes</title>
    <style>
        .movies {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .movie {
            padding: 10px;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        .showtimes {
            font-size: 0.8rem;
            color: #666;
        }
        /* Color coding for the number of showings */
        .shows-1 { background-color: rgba(179, 229, 252, 0.5); } /* Cooler color, fewer shows */
        .shows-2 { background-color: rgba(129, 212, 250, 0.5); }
        .shows-3 { background-color: rgba(79, 195, 247, 0.5); }
        .shows-4 { background-color: rgba(255, 204, 128, 0.5); }
        .shows-5-more { background-color: rgba(255, 138, 101, 0.5); } /* Warmer color, more shows */
    </style>
</head>
<body>
    <h1>Movie Showtimes</h1>
    <button onclick="fetchShowtimes('showtime_AMC Phipps Plaza 14.json')">Phipps Plaza 14</button>
    <button onclick="fetchShowtimes('showtime_AMC North Point Mall 12.json')">North Point Mall 12</button>
    <div id="showtimes-container"></div>

<script>
    function fetchShowtimes(file) {
        fetch(file)
        .then(response => response.json())
        .then(data => displayShowtimes(data))
        .catch(error => console.error('Error fetching data: ', error));
    }

    function displayShowtimes(data) {
        const container = document.getElementById('showtimes-container');
        container.innerHTML = ''; // Clear previous content
        data.forEach(day_info => {
            const dayElement = document.createElement('div');
            dayElement.innerHTML = `<h2>Day: ${day_info.day}${day_info.date ? ', ' + day_info.date : ''}</h2>`;
            const moviesElement = document.createElement('div');
            moviesElement.className = 'movies';

            day_info.movies.forEach(movie => {
                const movieElement = document.createElement('div');
                const totalShowings = movie.showing.reduce((acc, cur) => acc + cur.time.length, 0);
                movieElement.className = 'movie ' + getColorClass(totalShowings);

                let showingsDetail = movie.showing.map(show => {
                    const times = show.time;
                    const showCount = times.length;
                    const displayTimes = showCount > 3 ? `${times.slice(0, 3).join(', ')}...(${showCount} total)` : times.join(', ');
                    return `${show.type}: ${displayTimes}`;
                }).join('<br>');

                movieElement.innerHTML = `<strong>${movie.name}</strong><div class='showtimes'>${showingsDetail}</div>`;
                moviesElement.appendChild(movieElement);
            });
            dayElement.appendChild(moviesElement);
            container.appendChild(dayElement);
        });
    }

    function getColorClass(totalShowings) {
        // Apply coloring based on the total number of showtimes across all formats
        if (totalShowings >= 7) return 'shows-5-more';
        else if (totalShowings >= 5) return 'shows-4';
        else if (totalShowings >= 3) return 'shows-3';
        else if (totalShowings >= 2) return 'shows-2';
        else return 'shows-1';
    }
</script>

</body>
</html>
